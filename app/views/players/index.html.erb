<% provide(:title,"ホーム ")%>

<div class="home_content_left col-md-3">
  <%= render "shared/side_menu" %>
</div>
    
<div class="home_content_right col-md-9">
  <h1>プレイヤー検索</h1>
    <div class="panel-body">
      <%= search_form_for @search do |f| %>
        <div class="row">
          <div class="col-sm-9">
            <div class="form-group">
                <div class="form-group"> 
                  <%= f.label :gender_eq, "性別（必須）"%>
                  <%= f.select :gender_eq, Player.genders.map{|k| k}, {include_blank:"指定なし"},class: "form-control"%>     
                </div>
            </div>
          </div>
          <div class="col-sm-9">
            <div class="form-group">
                <div class="form-group"> 
                  <%= f.label :prefecture_eq, "地域（必須）"%>
                  <%= f.select :prefecture_eq, Player.prefectures.map{|k| k}, {include_blank:"指定なし"},class: "form-control"%>     
                </div>
            </div>
          </div>
          <div class="col-sm-9">
            <div class="form-group">
                <div class="form-group"> 
                  <%= f.label :available_day_eq, '練習参加可能日（必須）'%>
                  <%= f.select :available_day_eq, Player.available_days.map{|k| k}, {include_blank:"指定なし"},class: "form-control"%>     
                </div>
            </div>
          </div>
          <div class="col-sm-9">
            <div class="form-group">
              <% @positions.each do |position| %>
                <label>        
                  <%= f.check_box :player_positions_position_id_eq_any, { multiple: true }, position.id, '' %>
                  <%= position.display_name%>
                </label>
              <% end %>
            </div>
          </div>
          <div class="col-sm-6">
            <div class="form-group">
              <%= f.label :comment_cont, "フリーコメント（部分一致も含む）"%>
              <%= f.search_field :comment_cont, class: "form-control", include_blank: '未入力'%>
            </div>
          </div>
        </div>
        <%= f.submit '検索', class: "btn btn-primary" %>
        <%= link_to 'クリア', url_for, class: "btn btn-primary" %>
      <% end %>
    <div>
  </div>
  <h3>ユーザー一覧(検索結果)</h3><br>
  <div class="row">
    <% @players.each do |player| %>
      <div class="index_content col-lg-4 col-md-6 mb-4">
        <div class="card h-100">
          <%if player.user.image.attached? %>
            <%= image_tag player.user.image.variant(combine_options:{resize:"200x200^",crop:"400x700+0+0",gravity: :center}).processed %>
          <% else %>
            <img class="card-img-top" src="http://placehold.it/700x400?text=LET'S VOLLEY BALL">
          <% end %>
        <div class="card-body">
          <h4 class="card-title"><%= link_to "#{player.user.nickname}", user_path(player.user.id)%>( <small><%= player.prefecture%></small>)<small><%= player.gender %></small><hr></h4>
          <h5 class="card-subtitle" >希望ポジション</h5>
            <small class="position-name"><%= player.positions.pluck(:display_name).join(", ") %></small><hr>
          <h5 class="card-subtitle" >練習参加可能日(<%= player.available_day%>)</h5><hr>
            <p class="card-text"><%= player.comment%></p>
        </div>
          <div class="card-footer">
            <small class="text-muted"><%= link_to "詳しく見る", user_path(player.user.id)%></small>
          </div>
        </div>
      </div>
    <%end%>
  <%= paginate @players %>
  </div>
</div>